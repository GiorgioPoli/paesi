<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>World Explorer</title>
    
    <link rel="icon" href="icona-paesi.png" type="image/png">
    <link rel="apple-touch-icon" href="icona-paesi.png">
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="World Explorer">	
	
    <style>
        :root { --bg: #f8f9fa; --card: #ffffff; --accent: #007aff; }
        body { font-family: -apple-system, system-ui, sans-serif; background: var(--bg); margin: 0; overflow: hidden; }

        /* --- LISTA PRINCIPALE --- */
        #lista-paesi { padding: 20px; max-width: 600px; margin: 0 auto; height: 100vh; overflow-y: auto; box-sizing: border-box; }
        .header-lista { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; gap: 10px; }
        .header-lista h2 { margin: 0; font-weight: bold; font-size: 1.4rem; }
        #search-input { width: 100%; max-width: 180px; padding: 10px; border-radius: 10px; border: 1px solid #ddd; outline: none; }

        .lista-item {
            display: flex; align-items: center; background: white; padding: 12px;
            margin-bottom: 8px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            cursor: pointer;
        }
        .bandiera-mini { width: 40px; height: 25px; object-fit: cover; border-radius: 4px; margin-right: 15px; border: 1px solid #eee; }
        .nome-paese-lista { font-size: 1.1rem; font-weight: 500; }

        /* --- SCHEDA DETTAGLIO --- */
        #scheda-dettaglio {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: white; display: none; flex-direction: column; z-index: 1000;
            overflow-y: auto;
        }

        /* Bandiera più piccola ed elegante */
        .bandiera-header {
            width: 100%; display: flex; justify-content: center; padding: 40px 0 20px 0; background: #fff;
        }
        .bandiera-elegante {
            width: 180px; height: auto; border-radius: 8px; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: 1px solid #eee;
        }

        .info-container { display: flex; flex-direction: column; align-items: center; padding: 0 20px 20px 20px; }
        .info-paese { width: 100%; max-width: 450px; }
        .row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f2f2f7; font-size: 0.95rem; }
        .label { color: #8e8e93; }
        .value { color: #1c1c1e; font-weight: 500; text-align: right; }

        .regime-center {
            width: 100%; text-align: center; font-weight: bold; font-size: 1.2rem;
            padding: 20px 0; margin-top: 10px;
        }

        /* --- WIKIPEDIA --- */
        .wiki-container { width: 100%; min-height: 600px; border-top: 1px solid #eee; background: #fff; }
        #wiki-frame { width: 100%; height: 100%; border: none; min-height: 600px; }

        #btn-back {
            position: fixed; top: 15px; left: 15px; z-index: 2000;
            background: rgba(255,255,255,0.9); color: var(--accent); border: none;
            padding: 8px 16px; border-radius: 20px; font-weight: 600;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: none;
        }
    </style>
</head>
<body>

    <button id="btn-back" onclick="chiudiScheda()">‹ Indietro</button>

    <div id="lista-paesi">
        <div class="header-lista">
            <h2>Paesi del Mondo</h2>
            <input type="text" id="search-input" placeholder="Cerca paese..." oninput="filtraPaesi()">
        </div>
        <div id="lista-items"></div>
    </div>

    <div id="scheda-dettaglio">
        <div id="contenuto-scheda"></div>
        <div class="wiki-container">
            <iframe id="wiki-frame" src=""></iframe>
        </div>
    </div>

    <script src="dati.js"></script>
    <script>
        const listaItemsContainer = document.getElementById('lista-items');
        const schedaDettaglio = document.getElementById('scheda-dettaglio');
        const contenutoScheda = document.getElementById('contenuto-scheda');
        const wikiFrame = document.getElementById('wiki-frame');
        const btnBack = document.getElementById('btn-back');

        function getRegimeColor(regime) {
            if (!regime) return "#8e8e93";
            const r = regime.toLowerCase();
            if (r.includes("autoritario")) return "#ff3b30";
            if (r.includes("ibrido")) return "#ff9500";
            if (r.includes("imperfetta")) return "#af52de";
            if (r.includes("completa")) return "#34c759";
            return "#8e8e93";
        }

        function generaLista(filtro = "") {
            listaItemsContainer.innerHTML = "";
            paesi.forEach((p, index) => {
                if (p.Paese.toLowerCase().includes(filtro.toLowerCase())) {
                    const item = document.createElement('div');
                    item.className = 'lista-item';
                    item.onclick = () => apriScheda(index);
                    item.innerHTML = `
                        <img src="${p.Bandiera}" class="bandiera-mini">
                        <span class="nome-paese-lista">${p.Paese}</span>
                    `;
                    listaItemsContainer.appendChild(item);
                }
            });
        }

        function filtraPaesi() {
            const testo = document.getElementById('search-input').value;
            generaLista(testo);
        }

        function apriScheda(index) {
            const p = paesi[index];
            contenutoScheda.innerHTML = `
                <div class="bandiera-header">
                    <img src="${p.Bandiera}" class="bandiera-elegante">
                </div>
                <div class="info-container">
                    <h1 style="margin:0; font-size: 1.8rem;">${p.Paese}</h1>
                    <h3 style="color:#8e8e93; font-weight:400; margin: 5px 0 25px 0;">${p.Capitale}</h3>
                    
                    <div class="info-paese">
                        <div class="row"><span class="label">Continente</span><span class="value">${p["Continente"]}</span></div>
                        <div class="row"><span class="label">Popolazione</span><span class="value">${p["Popolazione"]}</span></div>
                        <div class="row"><span class="label">Superficie</span><span class="value">${p["Superficie"]} km²</span></div>
                        <div class="row"><span class="label">N. di paesi confinanti</span><span class="value">${p["Paesi confinanti"]}</span></div>
                        <div class="row"><span class="label">Altitudine Max</span><span class="value">${p["Altitudine massima"]}</span></div>
                        <div class="row"><span class="label">Data adesione ONU</span><span class="value">${p["Data adesione ONU"]}</span></div>
                        <div class="row"><span class="label">Democracy Index</span><span class="value">${p["Democracy Index"]}</span></div>
                        <div class="row"><span class="label">Rank Democracy</span><span class="value">#${p["Rank Democracy Index"]}</span></div>
                    </div>

                    <div class="regime-center" style="color: ${getRegimeColor(p["Tipo di regime"])}">
                        ${p["Tipo di regime"]}
                    </div>
                </div>
            `;
            wikiFrame.src = p.Wikipedia;
            schedaDettaglio.style.display = 'flex';
            btnBack.style.display = 'block';
            schedaDettaglio.scrollTop = 0;
        }

        function chiudiScheda() {
            schedaDettaglio.style.display = 'none';
            btnBack.style.display = 'none';
            wikiFrame.src = "";
            contenutoScheda.innerHTML = "";
        }

        generaLista();
    </script>
</body>
</html>